{"version":3,"file":"timeline.js","sources":["../../src/js/modules/timeline.js"],"sourcesContent":["import Flickity from 'flickity';\r\n\r\ndocument.addEventListener('DOMContentLoaded', function () {\r\n  // Initialize all timeline blocks\r\n  const timelineBlocks = document.querySelectorAll('.wp-block-timeline');\r\n\r\n  timelineBlocks.forEach(initializeTimeline);\r\n});\r\n\r\nfunction initializeTimeline(timelineBlock) {\r\n  const yearsCarousel = timelineBlock.querySelector('.timeline-years');\r\n  const contentCarousel = timelineBlock.querySelector('.timeline-content');\r\n\r\n  if (!yearsCarousel || !contentCarousel) {\r\n    console.warn('Timeline: Missing carousel elements');\r\n    return;\r\n  }\r\n\r\n  // Calculate middle slide index\r\n  const totalSlides = yearsCarousel.querySelectorAll('.timeline-year-cell').length;\r\n  const middleIndex = Math.floor(totalSlides / 2);\r\n\r\n  // Initialize Flickity instances\r\n  const yearsFlickity = new Flickity(yearsCarousel, {\r\n    wrapAround: false,\r\n    pageDots: false,\r\n    prevNextButtons: false,\r\n    cellAlign: 'center',\r\n    contain: true,\r\n    draggable: true,\r\n    freeScroll: true,\r\n    groupCells: false,\r\n    initialIndex: middleIndex,\r\n  });\r\n\r\n  const contentFlickity = new Flickity(contentCarousel, {\r\n    wrapAround: false,\r\n    pageDots: false,\r\n    prevNextButtons: true,\r\n    cellAlign: 'center',\r\n    contain: true,\r\n    draggable: false,\r\n    fade: true, // Smooth transition between content\r\n    initialIndex: middleIndex,\r\n  });\r\n\r\n  // Sync carousels and show only active content\r\n  yearsFlickity.on('change', function (index) {\r\n    // Update content carousel\r\n    contentFlickity.select(index, false, true);\r\n\r\n    // Update active states\r\n    updateActiveStates(timelineBlock, index);\r\n\r\n    // Show only active content slide\r\n    showActiveContentSlide(timelineBlock, index);\r\n  });\r\n\r\n  // Also sync when content carousel changes (via navigation buttons)\r\n  contentFlickity.on('change', function (index) {\r\n    // Update years carousel\r\n    yearsFlickity.select(index, false, true);\r\n\r\n    // Update active states\r\n    updateActiveStates(timelineBlock, index);\r\n\r\n    // Show only active content slide\r\n    showActiveContentSlide(timelineBlock, index);\r\n  });\r\n\r\n  // Handle direct clicks on year items\r\n  const yearItems = timelineBlock.querySelectorAll('.year-item');\r\n  yearItems.forEach((yearItem, index) => {\r\n    yearItem.addEventListener('click', function () {\r\n      yearsFlickity.select(index);\r\n    });\r\n  });\r\n\r\n  // Set initial active state using the calculated middle index\r\n  // Use setTimeout to ensure Flickity is fully initialized\r\n  setTimeout(() => {\r\n    updateActiveStates(timelineBlock, middleIndex);\r\n    showActiveContentSlide(timelineBlock, middleIndex);\r\n    \r\n    // Force Flickity to recalculate dimensions\r\n    contentFlickity.resize();\r\n    yearsFlickity.resize();\r\n  }, 100);\r\n  \r\n  // Additional resize after a longer delay to ensure proper height calculation\r\n  setTimeout(() => {\r\n    contentFlickity.resize();\r\n  }, 300);\r\n}\r\n\r\nfunction updateActiveStates(timelineBlock, activeIndex) {\r\n  // Remove all active states\r\n  const allYearItems = timelineBlock.querySelectorAll('.year-item');\r\n  allYearItems.forEach(item => item.classList.remove('is-active'));\r\n\r\n  // Add active state to current item\r\n  const activeYearItem = timelineBlock.querySelector(\r\n    `.timeline-year-cell[data-index=\"${activeIndex}\"] .year-item`\r\n  );\r\n  if (activeYearItem) {\r\n    activeYearItem.classList.add('is-active');\r\n  }\r\n}\r\n\r\nfunction showActiveContentSlide(timelineBlock, activeIndex) {\r\n  // Remove is-selected class from all content slides\r\n  const allContentSlides = timelineBlock.querySelectorAll('.timeline-content-cell');\r\n  allContentSlides.forEach(slide => slide.classList.remove('is-selected'));\r\n\r\n  // Add is-selected class to active slide\r\n  const activeSlide = timelineBlock.querySelector(\r\n    `.timeline-content-cell[data-index=\"${activeIndex}\"]`\r\n  );\r\n  if (activeSlide) {\r\n    activeSlide.classList.add('is-selected');\r\n  }\r\n}\r\n"],"names":["initializeTimeline","timelineBlock","yearsCarousel","contentCarousel","totalSlides","middleIndex","yearsFlickity","Flickity","contentFlickity","index","updateActiveStates","showActiveContentSlide","yearItem","activeIndex","item","activeYearItem","slide","activeSlide"],"mappings":"gDAEA,SAAS,iBAAiB,mBAAoB,UAAY,CAEjC,SAAS,iBAAiB,oBAAoB,EAEtD,QAAQA,CAAkB,CAC3C,CAAC,EAED,SAASA,EAAmBC,EAAe,CACzC,MAAMC,EAAgBD,EAAc,cAAc,iBAAiB,EAC7DE,EAAkBF,EAAc,cAAc,mBAAmB,EAEvE,GAAI,CAACC,GAAiB,CAACC,EAAiB,CACtC,QAAQ,KAAK,qCAAqC,EAClD,MACF,CAGA,MAAMC,EAAcF,EAAc,iBAAiB,qBAAqB,EAAE,OACpEG,EAAc,KAAK,MAAMD,EAAc,CAAC,EAGxCE,EAAgB,IAAIC,EAASL,EAAe,CAChD,WAAY,GACZ,SAAU,GACV,gBAAiB,GACjB,UAAW,SACX,QAAS,GACT,UAAW,GACX,WAAY,GACZ,WAAY,GACZ,aAAcG,CAClB,CAAG,EAEKG,EAAkB,IAAID,EAASJ,EAAiB,CACpD,WAAY,GACZ,SAAU,GACV,gBAAiB,GACjB,UAAW,SACX,QAAS,GACT,UAAW,GACX,KAAM,GACN,aAAcE,CAClB,CAAG,EAGDC,EAAc,GAAG,SAAU,SAAUG,EAAO,CAE1CD,EAAgB,OAAOC,EAAO,GAAO,EAAI,EAGzCC,EAAmBT,EAAeQ,CAAK,EAGvCE,EAAuBV,EAAeQ,CAAK,CAC7C,CAAC,EAGDD,EAAgB,GAAG,SAAU,SAAUC,EAAO,CAE5CH,EAAc,OAAOG,EAAO,GAAO,EAAI,EAGvCC,EAAmBT,EAAeQ,CAAK,EAGvCE,EAAuBV,EAAeQ,CAAK,CAC7C,CAAC,EAGiBR,EAAc,iBAAiB,YAAY,EACnD,QAAQ,CAACW,EAAUH,IAAU,CACrCG,EAAS,iBAAiB,QAAS,UAAY,CAC7CN,EAAc,OAAOG,CAAK,CAC5B,CAAC,CACH,CAAC,EAID,WAAW,IAAM,CACfC,EAAmBT,EAAeI,CAAW,EAC7CM,EAAuBV,EAAeI,CAAW,EAGjDG,EAAgB,OAAM,EACtBF,EAAc,OAAM,CACtB,EAAG,GAAG,EAGN,WAAW,IAAM,CACfE,EAAgB,OAAM,CACxB,EAAG,GAAG,CACR,CAEA,SAASE,EAAmBT,EAAeY,EAAa,CAEjCZ,EAAc,iBAAiB,YAAY,EACnD,QAAQa,GAAQA,EAAK,UAAU,OAAO,WAAW,CAAC,EAG/D,MAAMC,EAAiBd,EAAc,cACnC,mCAAmCY,CAAW,eAClD,EACME,GACFA,EAAe,UAAU,IAAI,WAAW,CAE5C,CAEA,SAASJ,EAAuBV,EAAeY,EAAa,CAEjCZ,EAAc,iBAAiB,wBAAwB,EAC/D,QAAQe,GAASA,EAAM,UAAU,OAAO,aAAa,CAAC,EAGvE,MAAMC,EAAchB,EAAc,cAChC,sCAAsCY,CAAW,IACrD,EACMI,GACFA,EAAY,UAAU,IAAI,aAAa,CAE3C"}