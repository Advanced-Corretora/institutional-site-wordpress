{"version":3,"file":"diferenciais.js","sources":["../../src/js/modules/diferenciais.js"],"sourcesContent":["import Flickity from 'flickity';\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  // Initialize all diferenciais carousel blocks\n  const diferenciaisBlocks = document.querySelectorAll('.wp-block-diferenciais-carousel');\n\n  diferenciaisBlocks.forEach(initializeDiferenciais);\n\n  // Additional check when window is fully loaded (including images)\n  window.addEventListener('load', function () {\n    diferenciaisBlocks.forEach(block => {\n      const carousel = block.querySelector('.diferenciais-carousel');\n      if (carousel) {\n        equalizeCardHeights(carousel);\n      }\n    });\n  });\n});\n\n// Global function to equalize heights for any carousel\nfunction equalizeCardHeights(carousel) {\n  const cards = carousel.querySelectorAll('.diferencial-item');\n  if (cards.length === 0) return;\n\n  // Reset heights to auto to get natural heights\n  cards.forEach(card => {\n    card.style.height = 'auto';\n  });\n\n  // Get the tallest card height\n  let maxHeight = 0;\n  cards.forEach(card => {\n    const cardHeight = card.offsetHeight;\n    if (cardHeight > maxHeight) {\n      maxHeight = cardHeight;\n    }\n  });\n\n  // Apply the max height to all cards\n  cards.forEach(card => {\n    card.style.height = maxHeight + 'px';\n  });\n}\n\nfunction initializeDiferenciais(diferenciaisBlock) {\n  const carousel = diferenciaisBlock.querySelector('.diferenciais-carousel');\n  const prevButton = diferenciaisBlock.querySelector('.diferenciais-prev');\n  const nextButton = diferenciaisBlock.querySelector('.diferenciais-next');\n\n  if (!carousel) {\n    console.warn('Diferenciais: Missing carousel element');\n    return;\n  }\n\n  // Check if mobile for responsive configuration\n  const isMobile = window.innerWidth <= 768;\n\n  // Initialize Flickity instance with responsive settings\n  const flickity = new Flickity(carousel, {\n    wrapAround: true,\n    pageDots: false,\n    prevNextButtons: true,\n    contain: isMobile ? false : true,\n    cellAlign: isMobile ? 'center' : 'left',\n    initialIndex: 0,\n    percentPosition: false,\n  });\n\n  // Equalize heights after Flickity is ready\n  flickity.on('ready', function () {\n    setTimeout(() => equalizeCardHeights(carousel), 100); // Small delay to ensure DOM is ready\n  });\n\n  // Also equalize immediately after initialization\n  setTimeout(() => equalizeCardHeights(carousel), 200);\n\n  // Re-equalize on window resize\n  flickity.on('resize', () => equalizeCardHeights(carousel));\n\n  // Re-equalize when images load (important for cards with images)\n  const images = carousel.querySelectorAll('img');\n  let loadedImages = 0;\n  const totalImages = images.length;\n\n  if (totalImages > 0) {\n    images.forEach(img => {\n      if (img.complete) {\n        loadedImages++;\n        if (loadedImages === totalImages) {\n          setTimeout(() => equalizeCardHeights(carousel), 50);\n        }\n      } else {\n        img.addEventListener('load', function () {\n          loadedImages++;\n          if (loadedImages === totalImages) {\n            setTimeout(() => equalizeCardHeights(carousel), 50);\n          }\n        });\n      }\n    });\n  }\n\n  // Custom navigation buttons\n  if (prevButton && nextButton) {\n    prevButton.addEventListener('click', function () {\n      flickity.previous();\n    });\n\n    nextButton.addEventListener('click', function () {\n      flickity.next();\n    });\n\n    // Update button states based on current slide\n    function updateButtonStates() {\n      if (!flickity.options.wrapAround) {\n        prevButton.disabled = flickity.selectedIndex === 0;\n        nextButton.disabled = flickity.selectedIndex === flickity.slides.length - 1;\n      }\n    }\n\n    // Listen for slide changes to update button states\n    flickity.on('change', updateButtonStates);\n\n    // Initial button state\n    updateButtonStates();\n  }\n\n  // Handle responsive behavior on window resize\n  function handleResize() {\n    const newIsMobile = window.innerWidth <= 768;\n    if (newIsMobile !== isMobile) {\n      // Destroy and recreate with new settings\n      flickity.destroy();\n      const newFlickity = new Flickity(carousel, {\n        wrapAround: true,\n        pageDots: false,\n        prevNextButtons: false,\n        contain: newIsMobile ? false : true,\n        cellAlign: newIsMobile ? 'center' : 'left',\n        initialIndex: 0,\n        percentPosition: false,\n      });\n\n      // Update reference\n      Object.assign(flickity, newFlickity);\n\n      // Re-equalize heights after recreating\n      setTimeout(() => equalizeCardHeights(carousel), 100);\n    } else {\n      flickity.resize();\n      // Re-equalize heights after resize\n      setTimeout(() => equalizeCardHeights(carousel), 100);\n    }\n  }\n\n  window.addEventListener('resize', handleResize);\n}\n"],"names":["diferenciaisBlocks","initializeDiferenciais","block","carousel","equalizeCardHeights","cards","card","maxHeight","cardHeight","diferenciaisBlock","prevButton","nextButton","isMobile","flickity","Flickity","images","loadedImages","totalImages","img","updateButtonStates","handleResize","newIsMobile","newFlickity"],"mappings":"gDAEA,SAAS,iBAAiB,mBAAoB,UAAY,CAExD,MAAMA,EAAqB,SAAS,iBAAiB,iCAAiC,EAEtFA,EAAmB,QAAQC,CAAsB,EAGjD,OAAO,iBAAiB,OAAQ,UAAY,CAC1CD,EAAmB,QAAQE,GAAS,CAClC,MAAMC,EAAWD,EAAM,cAAc,wBAAwB,EACzDC,GACFC,EAAoBD,CAAQ,CAEhC,CAAC,CACH,CAAC,CACH,CAAC,EAGD,SAASC,EAAoBD,EAAU,CACrC,MAAME,EAAQF,EAAS,iBAAiB,mBAAmB,EAC3D,GAAIE,EAAM,SAAW,EAAG,OAGxBA,EAAM,QAAQC,GAAQ,CACpBA,EAAK,MAAM,OAAS,MACtB,CAAC,EAGD,IAAIC,EAAY,EAChBF,EAAM,QAAQC,GAAQ,CACpB,MAAME,EAAaF,EAAK,aACpBE,EAAaD,IACfA,EAAYC,EAEhB,CAAC,EAGDH,EAAM,QAAQC,GAAQ,CACpBA,EAAK,MAAM,OAASC,EAAY,IAClC,CAAC,CACH,CAEA,SAASN,EAAuBQ,EAAmB,CACjD,MAAMN,EAAWM,EAAkB,cAAc,wBAAwB,EACnEC,EAAaD,EAAkB,cAAc,oBAAoB,EACjEE,EAAaF,EAAkB,cAAc,oBAAoB,EAEvE,GAAI,CAACN,EAAU,CACb,QAAQ,KAAK,wCAAwC,EACrD,MACF,CAGA,MAAMS,EAAW,OAAO,YAAc,IAGhCC,EAAW,IAAIC,EAASX,EAAU,CACtC,WAAY,GACZ,SAAU,GACV,gBAAiB,GACjB,QAAS,CAAAS,EACT,UAAWA,EAAW,SAAW,OACjC,aAAc,EACd,gBAAiB,EACrB,CAAG,EAGDC,EAAS,GAAG,QAAS,UAAY,CAC/B,WAAW,IAAMT,EAAoBD,CAAQ,EAAG,GAAG,CACrD,CAAC,EAGD,WAAW,IAAMC,EAAoBD,CAAQ,EAAG,GAAG,EAGnDU,EAAS,GAAG,SAAU,IAAMT,EAAoBD,CAAQ,CAAC,EAGzD,MAAMY,EAASZ,EAAS,iBAAiB,KAAK,EAC9C,IAAIa,EAAe,EACnB,MAAMC,EAAcF,EAAO,OAqB3B,GAnBIE,EAAc,GAChBF,EAAO,QAAQG,GAAO,CAChBA,EAAI,UACNF,IACIA,IAAiBC,GACnB,WAAW,IAAMb,EAAoBD,CAAQ,EAAG,EAAE,GAGpDe,EAAI,iBAAiB,OAAQ,UAAY,CACvCF,IACIA,IAAiBC,GACnB,WAAW,IAAMb,EAAoBD,CAAQ,EAAG,EAAE,CAEtD,CAAC,CAEL,CAAC,EAICO,GAAcC,EAAY,CAU5B,IAASQ,EAAT,UAA8B,CACvBN,EAAS,QAAQ,aACpBH,EAAW,SAAWG,EAAS,gBAAkB,EACjDF,EAAW,SAAWE,EAAS,gBAAkBA,EAAS,OAAO,OAAS,EAE9E,EAdAH,EAAW,iBAAiB,QAAS,UAAY,CAC/CG,EAAS,SAAQ,CACnB,CAAC,EAEDF,EAAW,iBAAiB,QAAS,UAAY,CAC/CE,EAAS,KAAI,CACf,CAAC,EAWDA,EAAS,GAAG,SAAUM,CAAkB,EAGxCA,EAAkB,CACpB,CAGA,SAASC,GAAe,CACtB,MAAMC,EAAc,OAAO,YAAc,IACzC,GAAIA,IAAgBT,EAAU,CAE5BC,EAAS,QAAO,EAChB,MAAMS,EAAc,IAAIR,EAASX,EAAU,CACzC,WAAY,GACZ,SAAU,GACV,gBAAiB,GACjB,QAAS,CAAAkB,EACT,UAAWA,EAAc,SAAW,OACpC,aAAc,EACd,gBAAiB,EACzB,CAAO,EAGD,OAAO,OAAOR,EAAUS,CAAW,EAGnC,WAAW,IAAMlB,EAAoBD,CAAQ,EAAG,GAAG,CACrD,MACEU,EAAS,OAAM,EAEf,WAAW,IAAMT,EAAoBD,CAAQ,EAAG,GAAG,CAEvD,CAEA,OAAO,iBAAiB,SAAUiB,CAAY,CAChD"}