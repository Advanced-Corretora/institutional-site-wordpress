{"version":3,"file":"homeSlider.js","sources":["../../src/js/modules/homeSlider.js"],"sourcesContent":["import Flickity from 'flickity';\r\n\r\nlet homeSliderInstances = [];\r\n\r\n// Global function to equalize heights for any slider\r\nfunction equalizeSlideHeights(slider) {\r\n  const slides = slider.querySelectorAll('.slider-cell');\r\n  if (slides.length === 0) return;\r\n\r\n  // Reset heights to auto to get natural heights\r\n  slides.forEach(slide => {\r\n    slide.style.height = 'auto';\r\n  });\r\n\r\n  // Get the tallest slide height\r\n  let maxHeight = 0;\r\n  slides.forEach(slide => {\r\n    const slideHeight = slide.offsetHeight;\r\n    if (slideHeight > maxHeight) {\r\n      maxHeight = slideHeight;\r\n    }\r\n  });\r\n\r\n  // Apply the max height to all slides\r\n  slides.forEach(slide => {\r\n    slide.style.height = maxHeight + 'px';\r\n  });\r\n}\r\n\r\n// Function to convert hex color to rgba with opacity\r\nconst hexToRgba = (hex, opacity) => {\r\n  const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n  if (result) {\r\n    const r = parseInt(result[1], 16);\r\n    const g = parseInt(result[2], 16);\r\n    const b = parseInt(result[3], 16);\r\n    return `rgba(${r}, ${g}, ${b}, ${opacity})`;\r\n  }\r\n  return null;\r\n};\r\n\r\n// Function to update submenu background color\r\nconst updateSubmenuColor = (color) => {\r\n  // Remove existing dynamic style if it exists\r\n  const existingStyle = document.getElementById('dynamic-submenu-style');\r\n  if (existingStyle) {\r\n    existingStyle.remove();\r\n  }\r\n\r\n  if (color) {\r\n    // Convert color to rgba with 95% opacity\r\n    const rgbaColor = hexToRgba(color, 0.95);\r\n    \r\n    if (rgbaColor) {\r\n      // Create and inject CSS\r\n      const style = document.createElement('style');\r\n      style.id = 'dynamic-submenu-style';\r\n      style.textContent = `\r\n        @media (min-width: 1024px) {\r\n          .header .menu .submenu-area {\r\n            background-color: ${rgbaColor} !important;\r\n          }\r\n        }\r\n      `;\r\n      document.head.appendChild(style);\r\n    }\r\n  }\r\n};\r\n\r\nconst createHomeSliderInstance = slider => {\r\n  const flkty = new Flickity(slider, {\r\n    wrapAround: true,\r\n    pageDots: false,\r\n    prevNextButtons: false,\r\n    contain: false,\r\n    cellAlign: 'center',\r\n    initialIndex: 0,\r\n    percentPosition: false,\r\n    autoPlay: 8000, // Auto-play a cada 8 segundos\r\n    pauseAutoPlayOnHover: true,\r\n    // Configurações específicas para full width\r\n    adaptiveHeight: false,\r\n    setGallerySize: true,\r\n  });\r\n\r\n  // Force hide navigation elements after initialization\r\n  flkty.on('ready', () => {\r\n    const dotsContainer = slider.querySelector('.flickity-page-dots');\r\n    if (dotsContainer) {\r\n      dotsContainer.style.display = 'none';\r\n    }\r\n    \r\n    const buttons = slider.querySelectorAll('.flickity-prev-next-button');\r\n    buttons.forEach(button => {\r\n      button.style.display = 'none';\r\n    });\r\n\r\n    // Equalize slide heights after Flickity is ready\r\n    setTimeout(() => equalizeSlideHeights(slider), 100);\r\n  });\r\n\r\n  // Also equalize immediately after initialization\r\n  setTimeout(() => equalizeSlideHeights(slider), 200);\r\n\r\n  // Re-equalize on window resize\r\n  flkty.on('resize', () => equalizeSlideHeights(slider));\r\n\r\n  // Re-equalize when images load (important for slides with background images)\r\n  const images = slider.querySelectorAll('img');\r\n  let loadedImages = 0;\r\n  const totalImages = images.length;\r\n\r\n  if (totalImages > 0) {\r\n    images.forEach(img => {\r\n      if (img.complete) {\r\n        loadedImages++;\r\n        if (loadedImages === totalImages) {\r\n          setTimeout(() => equalizeSlideHeights(slider), 50);\r\n        }\r\n      } else {\r\n        img.addEventListener('load', function () {\r\n          loadedImages++;\r\n          if (loadedImages === totalImages) {\r\n            setTimeout(() => equalizeSlideHeights(slider), 50);\r\n          }\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  // Handle slide change events\r\n  flkty.on('change', (index) => {\r\n    const currentSlide = slider.querySelector('.slider-cell.is-selected');\r\n    if (currentSlide) {\r\n      const submenuColor = currentSlide.getAttribute('data-submenu-color');\r\n      updateSubmenuColor(submenuColor);\r\n    }\r\n  });\r\n\r\n  // Set initial color on load\r\n  setTimeout(() => {\r\n    const initialSlide = slider.querySelector('.slider-cell.is-selected');\r\n    if (initialSlide) {\r\n      const submenuColor = initialSlide.getAttribute('data-submenu-color');\r\n      updateSubmenuColor(submenuColor);\r\n    }\r\n  }, 100);\r\n\r\n  return flkty;\r\n};\r\n\r\nconst destroyAllHomeSliderInstances = () => {\r\n  homeSliderInstances.forEach(instance => {\r\n    if (instance.flkty && typeof instance.flkty.destroy === 'function') {\r\n      instance.flkty.destroy();\r\n    }\r\n  });\r\n  homeSliderInstances = [];\r\n};\r\n\r\nconst initializeHomeSliders = () => {\r\n  const sliders = document.querySelectorAll('.gutenberg-home-slider');\r\n\r\n  sliders.forEach(slider => {\r\n    // Wait a bit to ensure Flickity is fully loaded\r\n    setTimeout(() => {\r\n      const flkty = createHomeSliderInstance(slider);\r\n\r\n      homeSliderInstances.push({\r\n        element: slider,\r\n        flkty: flkty,\r\n      });\r\n    }, 50);\r\n  });\r\n};\r\n\r\nconst gutenbergHomeSlider = () => {\r\n  initializeHomeSliders();\r\n\r\n  // Debounced resize handler\r\n  let resizeTimeout;\r\n  const handleResize = () => {\r\n    clearTimeout(resizeTimeout);\r\n    resizeTimeout = setTimeout(() => {\r\n      destroyAllHomeSliderInstances();\r\n      initializeHomeSliders();\r\n      \r\n      // Re-equalize heights after resize\r\n      setTimeout(() => {\r\n        const sliders = document.querySelectorAll('.gutenberg-home-slider');\r\n        sliders.forEach(slider => {\r\n          equalizeSlideHeights(slider);\r\n        });\r\n      }, 100);\r\n    }, 250);\r\n  };\r\n\r\n  window.addEventListener('resize', handleResize);\r\n};\r\n\r\n// Wait for both DOM and window load to ensure everything is ready\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n  // Additional delay to ensure Flickity library is fully loaded\r\n  setTimeout(gutenbergHomeSlider, 100);\r\n});\r\n\r\n// Fallback for window load\r\nwindow.addEventListener('load', () => {\r\n  // Only initialize if not already done\r\n  if (homeSliderInstances.length === 0) {\r\n    gutenbergHomeSlider();\r\n  }\r\n  \r\n  // Additional check when window is fully loaded (including images)\r\n  setTimeout(() => {\r\n    const sliders = document.querySelectorAll('.gutenberg-home-slider');\r\n    sliders.forEach(slider => {\r\n      equalizeSlideHeights(slider);\r\n    });\r\n  }, 100);\r\n});\r\n"],"names":["homeSliderInstances","equalizeSlideHeights","slider","slides","slide","maxHeight","slideHeight","hexToRgba","hex","opacity","result","r","g","b","updateSubmenuColor","color","existingStyle","rgbaColor","style","createHomeSliderInstance","flkty","Flickity","dotsContainer","button","images","loadedImages","totalImages","img","index","currentSlide","submenuColor","initialSlide","destroyAllHomeSliderInstances","instance","initializeHomeSliders","gutenbergHomeSlider","resizeTimeout","handleResize"],"mappings":"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"}